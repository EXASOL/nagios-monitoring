language: generic
services:
    - docker
script:
    - git clone https://github.com/EXASOL/nagios-monitoring/tree/icinga2-satellite-host
    - docker build -t exasol/icinga-monitoring:latest -f Dockerfile .
    - docker create --name exasol-icinga --hostname exasol-icinga exasol/icinga-monitoring:latest
    - docker start exasol-icinga
    - sleep 15s #wait until all services have been started
    - docker exec exasol-icinga bash -c 'pgrep icinga2 && pgrep apache2 && pgrep /usr/sbin/mysqld'
